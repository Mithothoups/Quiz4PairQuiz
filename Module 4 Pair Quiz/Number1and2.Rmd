---
title: "Number1and2"
author: "Joey Castillo and Justine Sison"
date: "7/28/2021"
output: html_document
library: (help = 'datasets')

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

Noise <- c(60, 63, 65, 70, 70, 70, 80, 90, 80, 80, 85, 89, 90, 90, 90, 90, 94, 100, 100, 100)
BP <- c(1, 0, 1, 2, 5, 1, 4, 6, 2, 3, 5, 4, 6, 8, 4, 5, 7, 9, 7, 6)


```





## Question 1 

### An article in the Journal of Sound and Vibration ["Measurement of Noise-Evoked Blood Pressure by Means of Averaging Method: Relation between Blood Pressure Rise and PSL" (1991, Vol. 151(3), pp. 383-394)] described a study investigating the relationship between noise exposure and hypertension. The following data are representative of those reported in the article. 

```{r}

df <- data.frame(
  x = c(60,63,65,70,70,70,80,90,80,80,85,89,90,90,90,90,94,100,100,100),
  y = c(1,0,1,2,5,1,4,6,2,3,5,4,6,8,4,5,7,9,7,6))
knitr::kable(df, "pipe", col.name=c("x" , "y"), align=c("c","c","c"))
             
```


### A. Draw a scatter diagram of y (blood pressure rise in millimeters of mercury) versus x (sound pressure level in decibels). Does a simple linear regression model seem reasonable in this situation?

```{r}
plot(Noise, BP, pch = 16, cex = 1.3, col = "blue", main = "BLOOD PRESSURE RISE PLOTTED AGAINST NOISE LEVELS", xlab = "NOISE LEVELS (db)", ylab = "BLOOD PRESSURE")

```


### B. Fit the simple linear regression model using least squares. Find an estimate of σ2.

For this question, we will use the following values:

$$
n=20
$$

$$
\bar x = 32.8, \bar y = 4.3
$$

$$
\sum_{i=1}^{20} {x_i} = 1656, \sum_{i=1}^{20} {y_i} = 86
$$

$$
\sum_{i=1}^{20} {x_i^2} = 140176, \sum_{i=1}^{20} {y_i^2} = 494
$$

$$
\sum_{i=1}^{20} {xy} = 7654
$$

The form for the simple linear regression model would be:

$$
\hat {y} = \hat {\beta_0} + \hat {\beta_1}x
$$

However, we don't know the values of β0 and β1, which are the coefficients. Let us first solve these coefficients. 

To compute for β1, let us use the following formulas:

$$
S_{xx}=\sum_{i=1}^{20} {x_i^2} - \frac{(\sum_{i=1}^{20} {x_i})^2}{n}
$$

$$
S_{xy}=\sum_{i=1}^{20} {xy} - \frac{(\sum_{i=1}^{20} {x_i})(\sum_{i=1}^{20} {y_i})}{n}
$$
We then substitute the values in these formulas above:

$$
S_{xx}=140176 - \frac{(1656)^2}{20} = 140176 - \frac{2742336}{20} = 3059.2
$$

$$
S_{xy}=7654 - \frac{(1656)(86)}{20} = 7654 - \frac{142416}{20} = 533.2
$$

We would now use these values to compute for β1 using this formula: 

$$
\hat {\beta_1} = \frac{S_{xy}}{S_{xx}} = \frac{533.2}{3059.2} = 0.1742939 \approx 0.1743
$$

We would then use the value for β1 along with other values/variables to compute for β0 in this formula:

$$
\hat {\beta_0} = \bar y - \hat {\beta_1}\bar x = 4.3 - (0.1742939)(82.8) = -10.1315349 \approx -10.132
$$

**Let us now substitute these values to solve for the linear regression model:**

$$
\hat {y} = -10.132 + 0.1743x
$$

To compute for the estimate of σ2, we would use this formula: 

$$
\sigma^2 = \frac{SSE}{n-2}
$$

However, to solve for SSE, we would use this formula:

$$
SSE = \sum_{i=1}^{20} {(y - \hat {y_1})^2} = 31.26648
$$

We now substitute the values:

$$
\sigma^2 = \frac {31.26648}{18} = 1.737027 \approx 1.737
$$

The  estimate of σ2 or estimated variance is **1.737** 

### C. Find the predicted mean rise in blood pressure level associated with a sound pressure level of 85 decibels.

To compute for the mean rise, we just need to substitute the x value from the linear regression model. Since the value of 85 has a unit of decibels, it would mean that the value is in the x-axis of the scatter plot or graph, thus We would let x be 85 to compute for the predicted mean rise. The blood pressure level mean rise would be:

$$
\hat {y} = -10.132 + 0.1743(85) = -10.132 + 14.8155 = 4.6835 
$$

The predicted mean rise in blood pressure level is **4.6835**

## Question 2

### An article in Optical Engineering ["Operating Curve Extraction of a Correlator's Filter" (2004, Vol. 43, pp. 2775-2779)] reported on the use of an optical correlator to perform an experiment by varying brightness and contrast. The resulting modulation is characterized by the useful range of gray levels. The data follow:

(insert table 2 here)

### A. Fit a multiple linear regression model to these data.

(insert scatter diagram here)

### B. Estimate σ2.
### C. Compute the standard errors of the regression coefficients.
### D. Predict the useful range when brightness = 80 and contrast = 75.

To compute for the useful range, we just have to substitute the values from the linear regression model. We would then use these values:

$$
x_1 = 80
$$

$$
x_2 = 75
$$

Let us then Substitute the given values:

$$
\hat{y} = 239 + 0.334(x_1)-2.72(x_2)= 239 + 0.334(80)-2.72(75) = 239 + 26.72 -204 = 61.72
$$


The predicted useful range is **61.72**

### E. Test for significance of regression using α=0.05. What is the P-value for this test?
### F. Construct a t-test on each regression coefficient. What conclusions can you draw about the variables in this model? Use α=0.05.





plot(BP,Noise, main= 'Regression for BP and Noise'
xlab = 'BP', ylab = 'Noise)

)


